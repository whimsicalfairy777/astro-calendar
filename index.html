<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Astro & Lunar Calendar</title>
  <link href="https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap" rel="stylesheet"/>
  <style>
    body { font-family:'UnifrakturMaguntia',cursive; background:#EEF3ED; text-align:center; padding:20px; overflow:hidden; color:#303328; }
    .calendar-container { background:#EEF3ED; border:3px solid #D1C9BD; padding:20px; display:inline-block; box-shadow:5px 5px 15px rgba(0,0,0,0.1); }
    h1 { margin:0 0 10px; background:#9C816E; color:#303328; padding:10px 20px; border:2px solid #D1C9BD; display:inline-block; font-size:32px; }
    .calendar { display:grid; grid-template-columns:repeat(7,40px); grid-gap:5px; justify-content:center; margin-bottom:15px; }
    .calendar div { width:40px; height:40px; line-height:40px; cursor:pointer; color:#303328; background:#F3EEEE; border:1px solid #D1C9BD; transition:all .2s; }
    .calendar .header { font-weight:bold; background:#D1C9BD; }
    .calendar div:hover { background:rgba(48,51,40,0.1); border-color:#303328; }
    .calendar .today { background:rgba(48,51,40,0.2); border-color:#303328; }
    #eventSummary { font-size:20px; padding:10px; background:#D1C9BD; border:2px solid #303328; display:inline-block; text-align:left; min-width:300px; max-width:90vw; color:#303328; }
    .star { position:absolute; color:#fff; animation:floatStars 5s linear infinite; opacity:0.8; }
    @keyframes floatStars { 0% { transform:translateY(0) scale(1); opacity:0.8 } 100% { transform:translateY(-100vh) scale(0.5); opacity:0 } }
  </style>
</head>
<body>
  <div class="calendar-container">
    <h1>✦ Astro & Lunar Calendar ✦</h1>
    <div id="calendar" class="calendar"></div>
    <div id="eventSummary">Loading events…</div>
  </div>
  <script>
    let events = [];
    fetch('events.json')
      .then(r => r.json())
      .then(data => {
        events = data;
        buildCalendar();
        document.getElementById('eventSummary').innerText = 'Click any date';
      });

    function buildCalendar() {
      const cal = document.getElementById('calendar'); cal.innerHTML = '';
      ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].forEach(d => {
        const h = document.createElement('div');
        h.textContent = d;
        h.classList.add('header');
        cal.appendChild(h);
      });

      const today = new Date(), y = today.getFullYear(), m = today.getMonth();
      const first = new Date(y,m,1).getDay(), days = new Date(y,m+1,0).getDate();

      for(let i=0; i<first; i++) cal.appendChild(document.createElement('div'));

      for(let d=1; d<=days; d++) {
        const dtStr = `${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
        const cell = document.createElement('div'); cell.textContent = d;

        if(dtStr === new Date().toISOString().slice(0,10)) cell.classList.add('today');

        cell.onclick = () => {
          const sum = document.getElementById('eventSummary');
          const ev = events.filter(e => e.datetime.slice(0,10) === dtStr);
          if (!ev.length) {
            sum.innerHTML = `<strong>${dtStr}</strong><br>No events recorded.`;
          } else {
            sum.innerHTML = `<strong>${dtStr}</strong><br><br>` + ev.map(e => `
              <strong>${e.event}</strong><br>
              <em>${e.meaning}</em><br>
              <span><strong>Advice:</strong> ${e.advice}</span><br><br>
            `).join('');
          }
        };
        cal.appendChild(cell);
      }
    }

    function createStar() {
      const s = document.createElement('div');
      s.className = 'star';
      s.textContent = '✦';
      s.style.fontSize = Math.random()*16+8+'px';
      s.style.left = Math.random()*100+'vw';
      s.style.animationDuration = Math.random()*3+2+'s';
      document.body.appendChild(s);
      setTimeout(()=>s.remove(),5000);
    }
    setInterval(createStar, 300);
  </script>
</body>
</html>
